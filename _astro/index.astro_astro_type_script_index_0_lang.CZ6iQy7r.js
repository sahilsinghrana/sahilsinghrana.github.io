class p{constructor(){this.init()}init(){this.setupCollapsibleSections(),this.setupInitialStates()}setupCollapsibleSections(){document.querySelectorAll(".section-header.collapsible").forEach(t=>{t.addEventListener("click",r=>{r.preventDefault(),this.toggleSection(t)})})}setupInitialStates(){["authSection","connectionSection","outputSection","advancedSection","bodySection"].forEach(t=>{const r=document.getElementById(t),n=document.querySelector(`[data-target="${t}"]`);r&&n&&this.collapseSection(r,n)})}toggleSection(e){const t=e.getAttribute("data-target");if(!t)return;const r=document.getElementById(t);if(!r)return;r.classList.contains("collapsed")?this.expandSection(r,e):this.collapseSection(r,e)}expandSection(e,t){t.classList.remove("collapsed"),e.classList.remove("collapsed"),e.style.maxHeight=e.scrollHeight+"px",e.style.opacity="1",setTimeout(()=>{e.classList.contains("collapsed")||(e.style.maxHeight="")},300)}collapseSection(e,t){e.style.maxHeight=e.scrollHeight+"px",t.classList.add("collapsed"),e.classList.add("collapsed")}expandAll(){const e=document.querySelectorAll(".section-content.collapsed"),t=document.querySelectorAll(".section-header.collapsed");e.forEach((r,n)=>{const o=t[n];o&&this.expandSection(r,o)})}collapseAll(){const e=document.querySelectorAll(".section-content:not(.collapsed)"),t=document.querySelectorAll(".section-header:not(.collapsed)");for(let r=1;r<e.length;r++){const n=e[r],o=t[r];o&&n&&this.collapseSection(n,o)}}getSectionState(e){const t=document.getElementById(e);return t?!t.classList.contains("collapsed"):!1}setSectionState(e,t){const r=document.getElementById(e),n=document.querySelector(`[data-target="${e}"]`);!r||!n||(t?this.expandSection(r,n):this.collapseSection(r,n))}}class f{form;headersContainer;bodyTypeSelect;bodyContent;fileUpload;authTypeSelect;authFields;constructor(){this.form=this.getRequiredElement("curlForm"),this.headersContainer=this.getRequiredElement("headersContainer"),this.bodyTypeSelect=this.getRequiredElement("bodyType"),this.bodyContent=this.getRequiredElement("bodyContent"),this.fileUpload=this.getRequiredElement("fileUpload"),this.authTypeSelect=this.getRequiredElement("authType"),this.authFields=this.getRequiredElement("authFields"),this.init()}getRequiredElement(e){const t=document.getElementById(e);if(!t)throw new Error(`Required element with id '${e}' not found in DOM`);return t}init(){this.setupHeaderManagement(),this.setupBodyTypeHandling(),this.setupAuthTypeHandling(),this.setupFormReset(),this.setupConditionalFields()}setupHeaderManagement(){const e=document.getElementById("addHeader");e?e.addEventListener("click",()=>this.addHeaderRow()):console.warn("Add header button not found"),this.setupHeaderRowEvents()}addHeaderRow(){const e=document.createElement("div");e.className="header-row";const t=document.createElement("input");t.type="text",t.placeholder="Header name",t.className="header-key",t.setAttribute("list","commonHeaders");const r=document.createElement("input");r.type="text",r.placeholder="Header value",r.className="header-value";const n=document.createElement("button");n.type="button",n.className="remove-header",n.textContent="Ã—",e.appendChild(t),e.appendChild(r),e.appendChild(n),this.headersContainer.appendChild(e),this.setupHeaderRowEvents(e),t.focus()}setupHeaderRowEvents(e=this.headersContainer){e.querySelectorAll(".remove-header").forEach(r=>{const n=r.cloneNode(!0);r.parentNode?.replaceChild(n,r),n.addEventListener("click",o=>{const a=o.target.closest(".header-row");a&&this.headersContainer.children.length>1&&a.remove()})})}setupBodyTypeHandling(){this.bodyTypeSelect?(this.bodyTypeSelect.addEventListener("change",()=>{this.handleBodyTypeChange()}),this.handleBodyTypeChange()):console.warn("Body type select not found")}handleBodyTypeChange(){if(!this.bodyTypeSelect)return;const e=this.bodyTypeSelect.value,t=document.getElementById("bodyData");e==="none"?(this.bodyContent?.classList.add("hidden"),this.fileUpload?.classList.add("hidden")):(this.bodyContent?.classList.remove("hidden"),this.fileUpload?.classList.add("hidden"),t&&this.updateBodyPlaceholder(e,t))}updateBodyPlaceholder(e,t){if(!t)return;const r={json:`{
  "key": "value",
  "number": 123,
  "array": [1, 2, 3]
}`,form:"key1=value1&key2=value2&key3=value3",multipart:`name=John Doe
email=john@example.com
file=@/path/to/file.txt`,raw:"Raw text content or any other format"};t.placeholder=r[e]||"Enter request body"}setupAuthTypeHandling(){this.authTypeSelect?(this.authTypeSelect.addEventListener("change",()=>{this.handleAuthTypeChange()}),this.handleAuthTypeChange()):console.warn("Auth type select not found")}handleAuthTypeChange(){if(!this.authTypeSelect)return;const e=this.authTypeSelect.value,t=document.getElementById("username"),r=document.getElementById("password"),n=t?.parentElement,o=r?.parentElement,a=document.getElementById("tokenField");e==="none"?this.authFields?.classList.add("hidden"):e==="bearer"?(this.authFields?.classList.remove("hidden"),n?.classList.add("hidden"),o?.classList.add("hidden"),a?.classList.remove("hidden")):(this.authFields?.classList.remove("hidden"),n?.classList.remove("hidden"),o?.classList.remove("hidden"),a?.classList.add("hidden"))}setupFormReset(){const e=document.getElementById("resetForm");e?e.addEventListener("click",()=>{this.resetForm()}):console.warn("Reset button not found")}setupConditionalFields(){const e=document.getElementById("ipv4"),t=document.getElementById("ipv6");e&&t&&(e.addEventListener("change",()=>{e.checked&&(t.checked=!1)}),t.addEventListener("change",()=>{t.checked&&(e.checked=!1)}));const r=document.getElementById("silent"),n=document.getElementById("verbose");r&&n&&(r.addEventListener("change",()=>{r.checked&&(n.checked=!1)}),n.addEventListener("change",()=>{n.checked&&(r.checked=!1)}));const o=document.getElementById("headersOnly"),a=document.getElementById("includeHeaders");o&&a&&o.addEventListener("change",()=>{o.checked&&(a.checked=!1)})}resetForm(){this.form&&this.form.reset(),this.headersContainer&&(this.headersContainer.innerHTML="",this.addHeaderRow()),this.handleBodyTypeChange(),this.handleAuthTypeChange();const e=document.getElementById("output");e&&e.classList.add("hidden"),document.querySelectorAll(".validation-errors").forEach(n=>n.remove());const r=document.getElementById("url");r&&r.focus()}getFormData(){if(!this.form)throw new Error("Form not available");const e=new FormData(this.form),t={headers:{}};if(e.forEach((n,o)=>{t[o]=n}),this.headersContainer&&this.headersContainer.querySelectorAll(".header-row").forEach(o=>{const a=o.querySelector(".header-key"),d=o.querySelector(".header-value");a?.value.trim()&&d?.value.trim()&&(t.headers[a.value.trim()]=d.value.trim())}),t.bodyType!=="none"){const n=document.getElementById("bodyData");t.body=n?.value.trim()||null}return["followRedirects","insecure","compressed","includeHeaders","headersOnly","verbose","silent","showError","ipv4","ipv6","failOnError"].forEach(n=>{t[n]=e.has(n)}),t}}function y(s){if(!s.trim())return!0;try{return JSON.parse(s),!0}catch{return!1}}function g(s){return typeof s!="string"||s.length===0||s.length>200?!1:!/[\x00-\x1F\x7F\r\n]/.test(s)}function b(s){return typeof s!="string"||s.length>16384?!1:!/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/.test(s)}function i(s){if(typeof s!="string")return"";let e=s.replace(/[\x00-\x1F\x7F]/g,"");return e=e.replace(/([\\$`"'|&;<>(){}[\]*?~!#%^])/g,"\\$1"),e=e.replace(/\$\(/g,"\\$("),e=e.replace(/`/g,"\\`"),e.length>1e4&&(e=e.substring(0,1e4)),e}function u(s){if(typeof s!="string")return"";const e=document.createElement("div");return e.textContent=s,e.innerHTML}function v(s){if(typeof s!="string")return null;try{const e=new URL(s);return["http:","https:","ftp:","ftps:","sftp:","scp:","file:","ldap:","ldaps:","smtp:","smtps:","pop3:","pop3s:","imap:","imaps:"].includes(e.protocol)?e.toString():null}catch{return null}}function C(s){const e=[];if(s.url?v(s.url)||e.push("Please enter a valid URL"):e.push("URL is required"),s.bodyType==="json"&&s.body&&(s.body.length>5242880?e.push("Request body too large (max 5MB)"):y(s.body)||e.push("Invalid JSON format in request body")),s.headers&&(Object.keys(s.headers).length>100&&e.push("Too many headers (max 100 allowed)"),Object.entries(s.headers).forEach(([r,n])=>{g(r)||e.push(`Invalid header name: ${u(r)} (contains control characters)`),b(n)||e.push(`Invalid header value for ${u(r)} (contains control characters)`)})),s.timeout){const t=Number(s.timeout);(isNaN(t)||t<1||t>86400)&&e.push("Timeout must be between 1 and 86400 seconds")}if(s.maxRedirs){const t=Number(s.maxRedirs);(isNaN(t)||t<0||t>1e3)&&e.push("Max redirects must be between 0 and 1000")}if(s.maxTime){const t=Number(s.maxTime);(isNaN(t)||t<1||t>86400)&&e.push("Max time must be between 1 and 86400 seconds")}return{isValid:e.length===0,errors:e}}function E(s){if(document.querySelectorAll(".validation-error").forEach(n=>n.remove()),s.length===0)return;const t=document.createElement("div");t.className="validation-errors",t.innerHTML=`
        <div class="error-header">Please fix the following errors:</div>
        <ul>
            ${s.map(n=>`<li>${n}</li>`).join("")}
        </ul>
    `;const r=document.getElementById("curlForm");r&&(r.insertBefore(t,r.firstChild),t.scrollIntoView({behavior:"smooth",block:"center"}))}class x{writeOutFormats;constructor(){this.writeOutFormats={status:"%{http_code}",time:"%{time_total}",size:"%{size_download}",all:"Status: %{http_code}\\nTime: %{time_total}s\\nSize: %{size_download} bytes\\nSpeed: %{speed_download} bytes/s"}}generate(e){let t="curl";const r=[];return e.method&&e.method!=="GET"&&r.push(`-X ${e.method}`),this.addHeaders(r,e),this.addAuthentication(r,e),this.addBodyData(r,e),this.addConnectionOptions(r,e),this.addOutputOptions(r,e),this.addAdvancedOptions(r,e),e.url&&r.push(`"${i(e.url)}"`),r.length>0&&(t+=" "+r.join(" ")),t}addHeaders(e,t){t.headers&&(Object.entries(t.headers).forEach(([r,n])=>{r&&n&&e.push(`-H "${i(r)}: ${i(n)}"`)}),t.bodyType==="json"&&t.body&&(Object.keys(t.headers).some(n=>n.toLowerCase()==="content-type")||e.push('-H "Content-Type: application/json"')),t.bodyType==="form"&&t.body&&(Object.keys(t.headers).some(n=>n.toLowerCase()==="content-type")||e.push('-H "Content-Type: application/x-www-form-urlencoded"')))}addAuthentication(e,t){if(!(!t.authType||t.authType==="none"))switch(t.authType){case"basic":t.username&&t.password&&e.push(`-u "${i(t.username)}:${i(t.password)}"`);break;case"bearer":t.token&&e.push(`-H "Authorization: Bearer ${i(t.token)}"`);break;case"digest":t.username&&t.password&&(e.push("--digest"),e.push(`-u "${i(t.username)}:${i(t.password)}"`));break;case"ntlm":t.username&&t.password&&(e.push("--ntlm"),e.push(`-u "${i(t.username)}:${i(t.password)}"`));break;case"negotiate":t.username&&t.password&&(e.push("--negotiate"),e.push(`-u "${i(t.username)}:${i(t.password)}"`));break}}addBodyData(e,t){if(!(!t.bodyType||t.bodyType==="none"))switch(t.bodyType){case"json":case"raw":t.body&&e.push(`-d '${i(t.body)}'`);break;case"form":t.body&&e.push(`-d "${i(t.body)}"`);break;case"multipart":t.body&&t.body.split(`
`).filter(n=>n.trim()).forEach(n=>{if(n.includes("=")){const[o,a]=n.split("=",2);a.startsWith("@")?e.push(`-F "${i(o.trim())}=${a}"`):e.push(`-F "${i(o.trim())}=${i(a)}"`)}});break}}addConnectionOptions(e,t){t.followRedirects&&e.push("-L"),t.insecure&&e.push("-k"),t.compressed&&e.push("--compressed"),t.timeout&&e.push(`--connect-timeout ${t.timeout}`),t.maxRedirs&&e.push(`--max-redirs ${t.maxRedirs}`),t.userAgent&&e.push(`-A "${i(t.userAgent)}"`),t.referer&&e.push(`-e "${i(t.referer)}"`)}addOutputOptions(e,t){t.includeHeaders&&e.push("-i"),t.headersOnly&&e.push("-I"),t.verbose&&e.push("-v"),t.silent&&e.push("-s"),t.showError&&e.push("-S"),t.outputFile&&e.push(`-o "${i(t.outputFile)}"`),t.writeOut&&this.writeOutFormats[t.writeOut]&&e.push(`-w "${this.writeOutFormats[t.writeOut]}"`)}addAdvancedOptions(e,t){if(t.proxy&&e.push(`--proxy "${i(t.proxy)}"`),t.interface&&e.push(`--interface "${i(t.interface)}"`),t.httpVersion){const r={"1.0":"--http1.0","1.1":"--http1.1",2:"--http2",3:"--http3"};r[t.httpVersion]&&e.push(r[t.httpVersion])}t.maxTime&&e.push(`--max-time ${t.maxTime}`),t.ipv4&&e.push("-4"),t.ipv6&&e.push("-6"),t.failOnError&&e.push("-f")}formatCommand(e){return e.replace(/\\\n/g,` \\
  `).replace(/^curl/,"curl").trim()}}async function w(s){try{return navigator.clipboard&&window.isSecureContext?(await navigator.clipboard.writeText(s),!0):h(s)}catch(e){return console.error("Failed to copy to clipboard:",e),h(s)}}function h(s){try{const e=document.createElement("textarea");e.value=s,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();const t=document.execCommand("copy");return document.body.removeChild(e),t}catch(e){return console.error("Fallback copy failed:",e),!1}}function S(s,e="Copy",t=2e3){const r=s.classList.contains("copied")||s.textContent?.includes("Copied");s.textContent=r?"âœ… Copied!":"ðŸ“‹ Copy",s.classList.add("copied"),setTimeout(()=>{s.textContent=e,s.classList.remove("copied")},t)}class T{collapsibleManager;formManager;curlGenerator;form;output;curlOutput;copyBtn;currentCommand="";debounceTimer;constructor(){try{this.collapsibleManager=new p,this.formManager=new f,this.curlGenerator=new x,this.form=this.getRequiredElement("curlForm"),this.output=this.getRequiredElement("output"),this.curlOutput=this.getRequiredElement("curlOutput"),this.copyBtn=this.getRequiredElement("copyBtn"),this.init()}catch(e){throw console.error("Error initializing CurlGeneratorApp:",e),e}}getRequiredElement(e){const t=document.getElementById(e);if(!t)throw new Error(`Required element with id '${e}' not found in DOM`);return t}init(){this.setupEventListeners(),this.setupKeyboardShortcuts(),this.loadSavedState()}setupEventListeners(){this.form.addEventListener("submit",t=>{t.preventDefault(),this.generateCurlCommand()}),this.copyBtn.addEventListener("click",()=>{this.copyCommand()}),this.form.addEventListener("input",()=>{this.debounce(()=>this.saveFormState(),1e3)});const e=document.getElementById("url");e.addEventListener("blur",()=>{this.validateUrl(e)})}setupKeyboardShortcuts(){document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.key==="Enter"&&(e.preventDefault(),this.generateCurlCommand()),(e.ctrlKey||e.metaKey)&&e.key==="c"&&!this.output.classList.contains("hidden")&&(window.getSelection()?.toString()||(e.preventDefault(),this.copyCommand())),e.key==="Escape"&&this.collapsibleManager.collapseAll()})}generateCurlCommand(){try{this.clearValidationErrors();const e=this.formManager.getFormData(),t=C(e);if(!t.isValid){E(t.errors);return}this.currentCommand=this.curlGenerator.generate(e),this.displayOutput(this.currentCommand),this.saveFormState()}catch(e){console.error("Error generating curl command:",e),this.showError("An error occurred while generating the curl command. Please check your input and try again.")}}displayOutput(e){this.curlOutput.textContent=e,this.output.classList.remove("hidden"),setTimeout(()=>{this.output.scrollIntoView({behavior:"smooth",block:"start"})},100),this.addSyntaxHighlighting()}addSyntaxHighlighting(){const e=this.curlOutput.textContent||"",r=this.escapeHtml(e).replace(/(curl)|(--[a-zA-Z-]+|-{1}[a-zA-Z]+)|((https?:\/\/[^\s"'<>]+))|(&quot;.*?&quot;)/g,(n,o,a,d,l)=>o?`<span class="curl-command">${o}</span>`:a?`<span class="curl-flag">${a}</span>`:d?`<span class="curl-url">${d}</span>`:l?`<span class="curl-string">${l}</span>`:n);this.curlOutput.innerHTML=r}escapeHtml(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}async copyCommand(){if(!this.currentCommand)return;await w(this.currentCommand)?S(this.copyBtn,"ðŸ“‹ Copy"):this.showError("Failed to copy to clipboard")}validateUrl(e){const t=e.value.trim();if(t)try{new URL(t),e.classList.remove("error")}catch{e.classList.add("error")}}saveFormState(){try{const e=this.formManager.getFormData();localStorage.setItem("curlGeneratorState",JSON.stringify(e))}catch(e){console.warn("Failed to save form state:",e)}}loadSavedState(){try{const e=localStorage.getItem("curlGeneratorState");if(!e)return;const t=JSON.parse(e);this.restoreFormState(t)}catch(e){console.warn("Failed to load saved state:",e)}}restoreFormState(e){if(Object.entries(e).forEach(([t,r])=>{const n=document.getElementById(t);n&&typeof r=="string"?n.value=r:n&&typeof r=="boolean"&&(n.checked=r)}),e.headers&&Object.keys(e.headers).length>0&&this.restoreHeaders(e.headers),e.body){const t=document.getElementById("bodyData");t&&(t.value=e.body)}this.formManager.handleBodyTypeChange(),this.formManager.handleAuthTypeChange()}restoreHeaders(e){const t=this.formManager.headersContainer;t.innerHTML="";const r=Object.entries(e);if(r.length===0){this.formManager.addHeaderRow();return}r.forEach(([n,o])=>{const a=document.createElement("div");a.className="header-row";const d=document.createElement("input");d.type="text",d.placeholder="Header name",d.className="header-key",d.setAttribute("list","commonHeaders"),d.value=n;const l=document.createElement("input");l.type="text",l.placeholder="Header value",l.className="header-value",l.value=o;const c=document.createElement("button");c.type="button",c.className="remove-header",c.textContent="Ã—",a.appendChild(d),a.appendChild(l),a.appendChild(c),t.appendChild(a)}),this.formManager.setupHeaderRowEvents()}clearValidationErrors(){document.querySelectorAll(".validation-errors").forEach(r=>r.remove()),document.querySelectorAll(".error").forEach(r=>r.classList.remove("error"))}showError(e){const t=document.createElement("div");t.className="error-notification",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},5e3)}debounce(e,t){this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(e,t)}}document.addEventListener("DOMContentLoaded",()=>{try{new T}catch(s){console.error("Failed to initialize Curl Generator App:",s);const e=document.createElement("div");e.style.cssText=`
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #e74c3c;
            color: white;
            padding: 16px 24px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            font-size: 14px;
            max-width: 90%;
            text-align: center;
        `,e.textContent="Failed to load the application. Please refresh the page and try again.",document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},1e4)}});const k=`
    .curl-command { color: #e74c3c; font-weight: bold; }
    .curl-flag { color: #3498db; }
    .curl-url { color: #27ae60; }
    .curl-string { color: #f39c12; }
    
    .error { border-color: #e74c3c !important; }
    
    .validation-errors {
        background: #fee;
        border: 1px solid #e74c3c;
        border-radius: 8px;
        padding: 12px;
        margin-bottom: 16px;
        color: #c0392b;
        font-size: var(--font-size-xs);
    }
    
    .validation-errors .error-header {
        font-weight: 600;
        margin-bottom: 6px;
    }
    
    .validation-errors ul {
        margin: 0;
        padding-left: 16px;
    }
    
    .validation-errors li {
        margin-bottom: 3px;
    }
    
    .error-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #e74c3c;
        color: white;
        padding: 8px 16px;
        border-radius: 6px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        z-index: 1000;
        animation: slideInRight 0.3s ease-out;
        font-size: var(--font-size-xs);
    }
    
    @keyframes slideInRight {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
`,m=document.createElement("style");m.textContent=k;document.head.appendChild(m);
